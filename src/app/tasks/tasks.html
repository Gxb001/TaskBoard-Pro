<div class="tasks-page">
  <!-- Conteneur pour les composants dynamiques (ViewContainerRef) -->
  <ng-container #dynamicComponentContainer></ng-container>

  <header class="page-header">
    <h1>{{ title }}</h1>
    <p class="subtitle">GÃ©rez toutes vos tÃ¢ches en un seul endroit</p>
  </header>

  <!-- Statistiques -->
  <div class="stats-bar">
    <div class="stat-card total">
      <span class="stat-icon">ğŸ“‹</span>
      <div class="stat-info">
        <span class="stat-value">{{ totalTasks$ | async }}</span>
        <span class="stat-label">Total</span>
      </div>
    </div>
    <div class="stat-card completed">
      <span class="stat-icon">âœ…</span>
      <div class="stat-info">
        <span class="stat-value">{{ completedCount$ | async }}</span>
        <span class="stat-label">TerminÃ©es</span>
      </div>
    </div>
    <div class="stat-card pending">
      <span class="stat-icon">â³</span>
      <div class="stat-info">
        <span class="stat-value">{{ pendingCount$ | async }}</span>
        <span class="stat-label">En cours</span>
      </div>
    </div>
    <div class="stat-card progress">
      <span class="stat-icon">ğŸ“Š</span>
      <div class="stat-info">
        <span class="stat-value">{{ progressPercentage$ | async }}%</span>
        <span class="stat-label">Progression</span>
      </div>
    </div>
  </div>

  <!-- Barre de progression -->
  <div class="progress-bar-container">
    <div class="progress-bar" [style.width.%]="progressPercentage$ | async"></div>
  </div>

  <!-- Formulaire d'ajout -->
  <section class="add-task-section">
    <h2>â• Nouvelle tÃ¢che</h2>
    <form class="add-task-form" (submit)="$event.preventDefault(); addTask(taskTitle.value, taskDesc.value, taskPriority.value); taskTitle.value=''; taskDesc.value=''">
      <div class="form-row">
        <input #taskTitle type="text" placeholder="Titre de la tÃ¢che *" class="form-input" required>
        <select #taskPriority class="form-select">
          <option value="low">ğŸŸ¢ PrioritÃ© basse</option>
          <option value="medium" selected>ğŸŸ¡ PrioritÃ© moyenne</option>
          <option value="high">ğŸ”´ PrioritÃ© haute</option>
        </select>
      </div>
      <div class="form-row">
        <input #taskDesc type="text" placeholder="Description (optionnel)" class="form-input full-width">
        <button type="submit" class="btn-add">Ajouter</button>
      </div>
    </form>
  </section>

  <!-- Conteneur des listes -->
  <div class="tasks-container">
    <!-- TÃ¢ches en cours -->
    <section class="tasks-column pending-column">
      <h2>â³ En cours ({{ pendingCount$ | async }})</h2>
      <div class="tasks-list">
        @for (task of pendingTasks$ | async; track task.id) {
          <div class="task-card" [class.priority-high]="task.priority === 'high'" [class.priority-medium]="task.priority === 'medium'" [class.priority-low]="task.priority === 'low'">
            <div class="task-main">
              <input type="checkbox" [checked]="task.completed" (change)="toggleTask(task.id)" class="task-checkbox">
              <div class="task-content">
                <h3>{{ task.title }}</h3>
                <p>{{ task.description }}</p>
              </div>
              <span class="priority-badge" [class]="task.priority">{{ task.priority }}</span>
            </div>
            <div class="task-actions">
              <span class="task-date">{{ task.createdAt | date:'dd/MM/yyyy HH:mm' }}</span>
              <div class="action-buttons">
                <button class="btn-highlight" (click)="highlightTask(task)" title="Mettre en avant">â­</button>
                <button class="btn-edit" (click)="editTask(task)" title="Ã‰diter">âœï¸</button>
                <button class="btn-delete" (click)="deleteTask(task.id)" title="Supprimer">ğŸ—‘ï¸</button>
              </div>
            </div>
          </div>
        } @empty {
          <div class="empty-state">
            <span class="empty-icon">ğŸ‰</span>
            <p>Aucune tÃ¢che en cours !</p>
          </div>
        }
      </div>
    </section>

    <!-- TÃ¢ches terminÃ©es -->
    <section class="tasks-column completed-column">
      <h2>âœ… TerminÃ©es ({{ completedCount$ | async }})</h2>
      <div class="tasks-list">
        @for (task of completedTasks$ | async; track task.id) {
          <div class="task-card completed">
            <div class="task-main">
              <input type="checkbox" [checked]="task.completed" (change)="toggleTask(task.id)" class="task-checkbox">
              <div class="task-content">
                <h3>{{ task.title }}</h3>
                <p>{{ task.description }}</p>
              </div>
            </div>
            <div class="task-actions">
              <span class="task-date">{{ task.createdAt | date:'dd/MM/yyyy HH:mm' }}</span>
              <div class="action-buttons">
                <button class="btn-highlight" (click)="highlightTask(task)" title="Mettre en avant">â­</button>
                <button class="btn-edit" (click)="editTask(task)" title="Ã‰diter">âœï¸</button>
                <button class="btn-delete" (click)="deleteTask(task.id)" title="Supprimer">ğŸ—‘ï¸</button>
              </div>
            </div>
          </div>
        } @empty {
          <div class="empty-state">
            <span class="empty-icon">ğŸ“</span>
            <p>Aucune tÃ¢che terminÃ©e</p>
          </div>
        }
      </div>
    </section>
  </div>
</div>

